```{r, include = FALSE}
library(here)
library(dplyr)
library(flextable)
library(officer)
library(tidyr, include.only = "pivot_longer")
library(stringr, include.only = "str_to_title")
library(knitr)
```


```{r, include=FALSE}
cat_data <- readxl::read_xlsx(here::here("data", "community_resources_map_data.xlsx"), sheet = "program_categories") %>% 
  select(c(program, main_category, sub_category))
```

```{r, include=FALSE}
dem_data <- readxl::read_xlsx(here::here("data", "community_resources_map_data.xlsx"), sheet = "demographics") %>% 
  left_join(., cat_data, by = "program") %>% 
  rename(
    "demo_sub_cat" = "sub_cat"
  ) 
```

```{r, echo = FALSE}
# Filter behavioral health service rows
laa <- dem_data %>% filter(main_category == "Legal Aid Advocacy") %>%
  # Group rows
  group_by(program, demo_sub_cat, demographic)
```


```{r, echo = FALSE}
# Split data frame into list of data frames by group
laa_table_list <- group_split(laa)
```
